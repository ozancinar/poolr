<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Estimate the Effective Number of Tests — meff • poolr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Estimate the Effective Number of Tests — meff"><meta property="og:description" content="Estimate the effective number of tests."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">poolr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../quick_start.html">Quick Start</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Estimate the Effective Number of Tests</h1>

    <div class="hidden name"><code>meff.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate the effective number of tests.<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">meff</span><span class="op">(</span><span class="va">R</span>, <span class="va">eigen</span>, <span class="va">method</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>a <em></em>\(k \times k\) symmetric matrix that reflects the correlation structure among the tests.</p></dd>

   <dt id="arg-eigen">eigen<a class="anchor" aria-label="anchor" href="#arg-eigen"></a></dt>
<dd><p>optional vector to directly supply the eigenvalues to the function (instead of computing them from the matrix given via <code>R</code>).</p></dd>

   <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>character string to specify the method to be used to estimate the effective number of tests (either <code>"nyholt"</code>, <code>"liji"</code>, <code>"gao"</code>, or <code>"galwey"</code>). See ‘Details’.</p></dd>

   <dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>other arguments.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>


<p>The function estimates the effective number of tests based on one of four different methods. All methods work by extracting the eigenvalues from the <em></em>\(R\) matrix supplied via the <code>R</code> argument (or from the eigenvalues directly passed via the <code>eigen</code> argument). Letting <em></em>\(\lambda_i\) denote the <em></em>\(i\)th eigenvalue of this matrix (with <em></em>\(i = 1, \ldots, k\)) in decreasing order, the effective number of tests (<em></em>\(m\)) is estimated as follows.</p>
<p><b>Method by Nyholt (2004)</b></p>
<p>\[m = 1 + (k - 1) \left(1 - \frac{\mbox{Var}(\lambda)}{k}\right)\] where <em></em>\(\mbox{Var}(\lambda)\) is the observed sample variance of the <em></em>\(k\) eigenvalues.</p>
<p><b>Method by Li &amp; Ji (2005)</b></p>
<p>\[m = \sum_{i = 1}^k f(|\lambda_i|)\] where <em></em>\(f(x) = I(x \ge 1) + (x - \lfloor x \rfloor)\) and <em></em>\(\lfloor \cdot \rfloor\) is the floor function.</p>
<p><b>Method by Gao et al. (2008)</b></p>
<p>\[m = \min(x) \; \mbox{such that} \; \frac{\sum_{i = 1}^x \lambda_{i}}{\sum_{i = 1}^k \lambda_{i}} &gt; C\] where <em></em>\(C\) is a pre-defined parameter which is set to 0.995 by default.</p>
<p><b>Method by Galwey (2009)</b></p>
<p>\[m = \frac{\left(\sum_{i = 1}^k \sqrt{\lambda_i'}\right)^2}{\sum_{i = 1}^k \lambda_i'}\] where <em></em>\(\lambda_i' = \max[0, \lambda_i]\).</p>
<p><b>Note:</b> For all methods that can yield a non-integer estimate (all but the method by Gao et al., 2008), the resulting estimate <em></em>\(m\) is rounded down to the nearest integer.</p>
<p><b>Specifying the R Matrix</b></p>
<p>The <em></em>\(R\) matrix should reflect the dependence structure among the tests. There is no general solution on how such a matrix should be constructed, as this depends on the type of test and the sidedness of these tests. For example, we can use the correlations among related but changing elements across the analyses/tests, or a function thereof, as a proxy for the dependence structure. For example, when conducting <em></em>\(k\) analyses with the same dependent variable and <em></em>\(k\) different independent variables, the correlations among the independent variables could serve as such a proxy. Analogously, if analyses are conducted for <em></em>\(k\) dependent variables with the same set of independent variables, the correlations among the dependent variables could be used instead.</p>
<p>If the tests of interest have test statistics that can be assumed to follow a multivariate normal distribution and a matrix is available that reflects the correlations among the test statistics (which might be approximated by the correlations among the interchanging independent or dependent variables), then the <code><a href="mvnconv.html">mvnconv</a></code> function can be used to convert this correlation matrix into the correlations among the (one- or two-sided) <em></em>\(p\)-values, which in turn can then be passed to the <code>R</code> argument. See ‘Examples’.</p>
<p><b>Not Positive Semi-Definite R</b></p>
<p>Depending on the way <em></em>\(R\) was constructed, it may happen that this matrix is not positive semi-definite, leading to negative eigenvalues. The methods given above can all still be carried out in this case. However, another possibility is to handle such a case by using an algorithm that finds the nearest positive (semi-)definite matrix (e.g., Higham 2002) before passing this matrix to the function (see <code><a href="https://rdrr.io/pkg/Matrix/man/nearPD.html" class="external-link">nearPD</a></code> from the <span class="pkg">Matrix</span> package for a corresponding implementation).</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A scalar giving the estimate of the effective number of tests.</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p>For <code>method = "gao"</code>, <code>C = 0.995</code> by default, but a different value of <code>C</code> can be passed to the function via <code>...</code> (e.g., <code>meff(R, method = "gao", C = 0.95)</code>).</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Ozan Cinar <a href="mailto:ozancinar86@gmail.com">ozancinar86@gmail.com</a> <br>
   Wolfgang Viechtbauer <a href="mailto:wvb@wvbauer.com">wvb@wvbauer.com</a> <br></p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Cinar, O. &amp; Viechtbauer, W. (2022). The poolr package for combining independent and dependent p values. <em>Journal of Statistical Software</em>, <b>101</b>(1), 1–42. <code>https://doi.org/10.18637/jss.v101.i01</code></p>
<p>Gao, X., Starmer, J., &amp; Martin, E. R. (2008). A multiple testing correction method for genetic association studies using correlated single nucleotide polymorphisms. <em>Genetic Epidemiology, 32</em>(4), 361–369.</p>
<p>Galwey, N. W. (2009). A new measure of the effective number of tests, a practical tool for comparing families of non-independent significance tests. <em>Genetic Epidemiology, 33</em>(7), 559–568.</p>
<p>Higham, N. J. (2002). Computing the nearest correlation matrix: A problem from finance. <em>IMA Journal of Numerical Analysis, 22</em>(3), 329–343.</p>
<p>Li, J., &amp; Ji, L. (2005). Adjusting multiple testing in multilocus analyses using the eigenvalues of a correlation matrix. <em>Heredity, 95</em>(3), 221–227.</p>
<p>Nyholt, D. R. (2004). A simple correction for multiple testing for single-nucleotide polymorphisms in linkage disequilibrium with each other. <em>American Journal of Human Genetics, 74</em>(4), 765–769.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># copy LD correlation matrix into r (see help(grid2ip) for details on these data)</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="va">grid2ip.ld</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># estimate the effective number of tests based on the LD correlation matrix</span></span></span>
<span class="r-in"><span><span class="fu">meff</span><span class="op">(</span><span class="va">r</span>, method <span class="op">=</span> <span class="st">"nyholt"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
<span class="r-in"><span><span class="fu">meff</span><span class="op">(</span><span class="va">r</span>, method <span class="op">=</span> <span class="st">"liji"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 15</span>
<span class="r-in"><span><span class="fu">meff</span><span class="op">(</span><span class="va">r</span>, method <span class="op">=</span> <span class="st">"gao"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18</span>
<span class="r-in"><span><span class="fu">meff</span><span class="op">(</span><span class="va">r</span>, method <span class="op">=</span> <span class="st">"galwey"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 13</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use mvnconv() to convert the LD correlation matrix into a matrix with the</span></span></span>
<span class="r-in"><span><span class="co"># correlations among the (two-sided) p-values assuming that the test</span></span></span>
<span class="r-in"><span><span class="co"># statistics follow a multivariate normal distribution with correlation</span></span></span>
<span class="r-in"><span><span class="co"># matrix r (note: 'side = 2' by default in mvnconv())</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mvnconv.html">mvnconv</a></span><span class="op">(</span><span class="va">r</span>, target <span class="op">=</span> <span class="st">"p"</span>, cov2cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="co"># show only rows/columns 1-5</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.00000000 0.02160864 0.022809124 0.010804322 0.097238896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.02160864 1.00000000 0.013205282 0.000000000 0.042016807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.02280912 0.01320528 1.000000000 0.006002401 0.006002401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.01080432 0.00000000 0.006002401 1.000000000 0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.09723890 0.04201681 0.006002401 0.000000000 1.000000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># use this matrix instead for estimating the effective number of tests</span></span></span>
<span class="r-in"><span><span class="fu">meff</span><span class="op">(</span><span class="fu"><a href="mvnconv.html">mvnconv</a></span><span class="op">(</span><span class="va">r</span>, target <span class="op">=</span> <span class="st">"p"</span>, cov2cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"nyholt"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 22</span>
<span class="r-in"><span><span class="fu">meff</span><span class="op">(</span><span class="fu"><a href="mvnconv.html">mvnconv</a></span><span class="op">(</span><span class="va">r</span>, target <span class="op">=</span> <span class="st">"p"</span>, cov2cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"liji"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 21</span>
<span class="r-in"><span><span class="fu">meff</span><span class="op">(</span><span class="fu"><a href="mvnconv.html">mvnconv</a></span><span class="op">(</span><span class="va">r</span>, target <span class="op">=</span> <span class="st">"p"</span>, cov2cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"gao"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 23</span>
<span class="r-in"><span><span class="fu">meff</span><span class="op">(</span><span class="fu"><a href="mvnconv.html">mvnconv</a></span><span class="op">(</span><span class="va">r</span>, target <span class="op">=</span> <span class="st">"p"</span>, cov2cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"galwey"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 20</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ozan Cinar, Wolfgang Viechtbauer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

      </footer></div>






  </body></html>

