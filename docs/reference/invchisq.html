<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Inverse Chi-Square Method — invchisq • poolr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Inverse Chi-Square Method — invchisq"><meta property="og:description" content="Function to carry out the inverse chi-square method."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">poolr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../quick_start.html">Quick Start</a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Inverse Chi-Square Method</h1>
    
    <div class="hidden name"><code>invchisq.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function to carry out the inverse chi-square method.<script id="MathJax-script" async src="../../mathjaxr/doc/mathjax/es5/tex-chtml-full.js"></script></p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">invchisq</span><span class="op">(</span><span class="va">p</span>, adjust <span class="op">=</span> <span class="st">"none"</span>, <span class="va">R</span>, <span class="va">m</span>,
         size <span class="op">=</span> <span class="fl">10000</span>, <span class="va">threshold</span>, side <span class="op">=</span> <span class="fl">2</span>, <span class="va">batchsize</span>, nearpd <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>p</dt>
<dd><p>vector of length \(k\) with the (one- or two-sided) p-values to be combined.</p></dd>
<dt>adjust</dt>
<dd><p>character string to specify an adjustment method to account for dependence. The default is <code>"none"</code>, in which case no adjustment is applied. Methods <code>"nyholt"</code>, <code>"liji"</code>, <code>"gao"</code>, or <code>"galwey"</code> are adjustments based on an estimate of the effective number of tests (see <code><a href="meff.html">meff</a></code>). Adjustment method <code>"empirical"</code> uses an empirically-derived null distribution using pseudo replicates. Finally, method <code>"generalized"</code> uses a generalization of the inverse chi-square method based on multivariate theory. See ‘Details’.</p></dd>
<dt>R</dt>
<dd><p>a \(k \times k\) symmetric matrix that reflects the dependence structure among the tests. Must be specified if <code>adjust</code> is set to something other than <code>"none"</code>. See ‘Details’.</p></dd>
<dt>m</dt>
<dd><p>optional scalar (between 1 and \(k\)) to manually specify the effective number of tests (instead of estimating it via one of the methods described above).</p></dd>
<dt>size</dt>
<dd><p>size of the empirically-derived null distribution. Can also be a numeric vector of sizes, in which case a stepwise algorithm is used. This (and the following arguments) are only relevant when <code>adjust = "empirical"</code>.</p></dd>
<dt>threshold</dt>
<dd><p>numeric vector to specify the significance thresholds for the stepwise algorithm (only relevant when <code>size</code> is a vector).</p></dd>
<dt>side</dt>
<dd><p>scalar to specify the sidedness of the \(p\)-values that are used to simulate the null distribution (2, by default, for two-sided tests; 1 for one-sided tests).</p></dd>
<dt>batchsize</dt>
<dd><p>optional scalar to specify the batch size for generating the null distribution. When unspecified (the default), this is done in a single batch.</p></dd>
<dt>nearpd</dt>
<dd><p>logical indicating if a negative definite <code>R</code> matrix should be turned into the nearest positive definite matrix (only relevant when <code>adjust = "empirical"</code> or <code>adjust = "generalized"</code>).</p></dd>
<dt>...</dt>
<dd><p>other arguments.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    

<p><b>Inverse Chi-Square Method</b></p>
<p>By default (i.e., when <code>adjust = "none"</code>), the function applies the inverse chi-square method to the \(p\)-values. Letting \(p_1, p_2, \ldots, p_k\) denote the individual (one- or two-sided) \(p\)-values of the \(k\) hypothesis tests to be combined, the test statistic is then computed with \[X^2 = \sum_{i = 1}^k F^{-1}(1 - p_i, 1)\] where \(F^{-1}(\cdot,1)\) denotes the inverse of the cumulative distribution function of a chi-square distribution with one degree of freedom. Under the joint null hypothesis, the test statistic follows a chi-square distribution with \(k\) degrees of freedom which is used to compute the combined \(p\)-value.</p>
<p>The inverse chi-square method assumes that the \(p\)-values to be combined are independent. If this is not the case, the method can either be conservative (not reject often enough) or liberal (reject too often), depending on the dependence structure among the tests. In this case, one can adjust the method to account for such dependence (to bring the Type I error rate closer to some desired nominal significance level).</p>
<p><b>Adjustment Based on the Effective Number of Tests</b></p>
<p>When <code>adjust</code> is set to <code>"nyholt"</code>, <code>"liji"</code>, <code>"gao"</code> or <code>"galwey"</code>, the inverse chi-square method is adjusted based on an estimate of the effective number of tests (see <code><a href="meff.html">meff</a></code> for details on these methods for estimating the effective number of tests). In this case, argument <code>R</code> needs to be set to a matrix that reflects the dependence structure among the tests.</p>
<p>There is no general solution for constructing such a matrix, as this depends on the type of test that generated the \(p\)-values and the sidedness of these tests. If the \(p\)-values are obtained from tests whose test statistics can be assumed to follow a multivariate normal distribution and a matrix is available that reflects the correlations among the test statistics, then the <code><a href="mvnconv.html">mvnconv</a></code> function can be used to convert this correlation matrix into the correlations among the (one- or two-sided) \(p\)-values, which can then be passed to the <code>R</code> argument. See ‘Examples’.</p>
<p>Once the effective number of tests, \(m\), is estimated based on <code>R</code> using one of the four methods described above, the test statistic of the inverse chi-square method can be modified with \[\tilde{X}^2 = \frac{m}{k} \times X^2\] which is then assumed to follow a chi-square distribution with \(m\) degrees of freedom.</p>
<p>Alternatively, one can also directly specify the effective number of tests via the <code>m</code> argument (e.g., if some other method not implemented in the <span class="pkg">poolr</span> package is used to estimate the effective number of tests). Argument <code>R</code> is then irrelevant and doesn't need to be specified.</p>
<p><b>Adjustment Based on an Empirically-Derived Null Distribution</b></p>
<p>When <code>adjust = "empirical"</code>, the combined \(p\)-value is computed based on an empirically-derived null distribution using pseudo replicates (using the <code><a href="empirical.html">empirical</a></code> function). This is appropriate if the test statistics that generated the \(p\)-values to be combined can be assumed to follow a multivariate normal distribution and a matrix is available that reflects the correlations among the test statistics (which is specified via the <code>R</code> argument). In this case, test statistics are repeatedly simulated from a multivariate normal distribution under the joint null hypothesis, converted into one- or two-sided \(p\)-values (depending on the <code>side</code> argument), and the inverse chi-square method is applied. Repeating this process <code>size</code> times yields a null distribution based on which the combined \(p\)-value can be computed, or more precisely, estimated, since repeated applications of this method will yield (slightly) different results. To obtain a stable estimate of the combined \(p\)-value, <code>size</code> should be set to a large value (the default is <code>10000</code>, but this can be increased for a more precise estimate). If we consider the combined \(p\)-value an estimate of the ‘true’ combined \(p\)-value that would be obtained for a null distribution of infinite size, we can also construct a 95% (pseudo) confidence interval based on a binomial distribution.</p>
<p>If <code>batchsize</code> is unspecified, the null distribution is simulated in a single batch, which requires temporarily storing a matrix with dimensions <code>[size,k]</code>. When <code>size*k</code> is large, allocating the memory for this matrix might not be possible. Instead, one can specify a <code>batchsize</code> value, in which case a matrix with dimensions <code>[batchsize,k]</code> is repeatedly simulated until the desired size of the null distribution has been obtained.</p>
<p>One can also specify a vector for the <code>size</code> argument, in which case one must also specify a corresponding vector for the <code>threshold</code> argument. In that case, a stepwise algorithm is used that proceeds as follows. For <code>j = 1, ..., length(size)</code>,</p><ol><li><p>estimate the combined \(p\)-value based on <code>size[j]</code></p></li>
<li><p>if the combined \(p\)-value is \(\ge\) than <code>threshold[j]</code>, stop (and report the combined \(p\)-value), otherwise go back to 1.</p></li>
</ol><p>By setting <code>size</code> to increasing values (e.g., <code>size = c(1000, 10000, 100000)</code>) and <code>threshold</code> to decreasing values (e.g., <code>threshold = c(.10, .01, 0)</code>), one can quickly obtain a fairly accurate estimate of the combined \(p\)-value if it is far from significant (e.g., \(\ge\) .10), but hone in on a more accurate estimate for a combined \(p\)-value that is closer to 0. Note that the last value of <code>threshold</code> should be 0 (and is forced to be inside of the function), so that the algorithm is guaranteed to terminate (hence, one can also leave out the last value of <code>threshold</code>, so <code>threshold = c(.10, .01)</code> would also work in the example above). One can also specify a single <code>threshold</code> (which is replicated as often as necessary depending on the length of <code>size</code>).</p>
<p><b>Adjustment Based on Multivariate Theory</b></p>
<p>When <code>adjust = "generalized"</code>, the inverse chi-square method is computed based on a Satterthwaite approximation that accounts for the dependence among the tests, assuming that the test statistics that generated the \(p\)-values follow a multivariate normal distribution. In that case, <code>R</code> needs to be set equal to a matrix that contains the covariances among the \(F^{-1}(1 - p_i, 1)\) values. If a matrix is available that reflects the correlations among the test statistics, this can be converted into the required covariance matrix using the <code><a href="mvnconv.html">mvnconv</a></code> function. See ‘Examples’.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of class <code>"poolr"</code>. The object is a list containing the following components:</p>
<dl><dt>p</dt>
<dd><p>combined \(p\)-value.</p></dd>
<dt>ci</dt>
<dd><p>confidence interval for the combined \(p\)-value (only when <code>adjust = "empirical"</code>; otherwise <code>NULL</code>).</p></dd>
<dt>k</dt>
<dd><p>number of \(p\)-values that were combined.</p></dd>
<dt>m</dt>
<dd><p>estimate of the effective number of tests (only when <code>adjust</code> is one of <code>"nyholt"</code>, <code>"liji"</code>, <code>"gao"</code> or <code>"galwey"</code>; otherwise <code>NULL</code>).</p></dd>
<dt>adjust</dt>
<dd><p>chosen adjustment method.</p></dd>
<dt>statistic</dt>
<dd><p>value of the (adjusted) test statistic.</p></dd>
<dt>fun</dt>
<dd><p>name of calling function.</p></dd>
</dl></div>
    <div id="note">
    <h2>Note</h2>
    <p>The methods underlying <code>adjust = "empirical"</code> and <code>adjust = "generalized"</code> assume that the test statistics that generated the \(p\)-values to be combined follow a multivariate normal distribution. Hence, the matrix specified via <code>R</code> must be positive definite. If it is not and <code>nearpd = TRUE</code>, it will be turned into one (based on Higham, 2002, and a slightly simplified version of <code><a href="https://rdrr.io/pkg/Matrix/man/nearPD.html" class="external-link">nearPD</a></code> from the <span class="pkg">Matrix</span> package).</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Ozan Cinar <a href="mailto:ozancinar86@gmail.com">ozancinar86@gmail.com</a> <br>
   Wolfgang Viechtbauer <a href="mailto:wvb@wvbauer.com">wvb@wvbauer.com</a> <br></p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Cinar, O. &amp; Viechtbauer, W. (2022). The poolr package for combining independent and dependent p values. <em>Journal of Statistical Software</em>, <b>101</b>(1), 1--42. <code>https://doi.org/10.18637/jss.v101.i01</code></p>   
<p>Higham, N. J. (2002). Computing the nearest correlation matrix: A problem from finance. <em>IMA Journal of Numerical Analysis, 22</em>(3), 329--343.</p>
<p>Lancaster, H. O. (1961). The combination of probabilities: An application of orthonormal functions. <em>Australian Journal of Statistics, 3</em>(1), 20--33.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="co"># copy p-values and LD correlation matrix into p and r</span></span>
<span class="r-in"><span class="co"># (see help(grid2ip) for details on these data)</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">grid2ip.p</span></span>
<span class="r-in"><span class="va">r</span> <span class="op">&lt;-</span> <span class="va">grid2ip.ld</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># apply the inverse chi-square method</span></span>
<span class="r-in"><span class="fu">invchisq</span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-values with:      inverse chi-square method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of p-values combined: 23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test statistic:              85.219 ~ chi-square(df = 23) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjustment:                  none </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-value:            4.447048e-09 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># use mvnconv() to convert the LD correlation matrix into a matrix with the</span></span>
<span class="r-in"><span class="co"># correlations among the (two-sided) p-values assuming that the test</span></span>
<span class="r-in"><span class="co"># statistics follow a multivariate normal distribution with correlation</span></span>
<span class="r-in"><span class="co"># matrix r (note: 'side = 2' by default in mvnconv())</span></span>
<span class="r-in"><span class="fu"><a href="mvnconv.html">mvnconv</a></span><span class="op">(</span><span class="va">r</span>, target <span class="op">=</span> <span class="st">"p"</span>, cov2cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="co"># show only rows/columns 1-5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]        [,3]        [,4]        [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 1.00000000 0.02160864 0.022809124 0.010804322 0.097238896</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.02160864 1.00000000 0.013205282 0.000000000 0.042016807</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.02280912 0.01320528 1.000000000 0.006002401 0.006002401</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.01080432 0.00000000 0.006002401 1.000000000 0.000000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.09723890 0.04201681 0.006002401 0.000000000 1.000000000</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># adjustment based on estimates of the effective number of tests</span></span>
<span class="r-in"><span class="fu">invchisq</span><span class="op">(</span><span class="va">p</span>, adjust <span class="op">=</span> <span class="st">"nyholt"</span>, R <span class="op">=</span> <span class="fu"><a href="mvnconv.html">mvnconv</a></span><span class="op">(</span><span class="va">r</span>, target <span class="op">=</span> <span class="st">"p"</span>, cov2cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-values with:      inverse chi-square method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of p-values combined: 23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test statistic:              81.513 ~ chi-square(df = 22) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjustment:                  effective number of tests (m = 22; Nyholt, 2004) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-value:            9.12e-09 </span>
<span class="r-in"><span class="fu">invchisq</span><span class="op">(</span><span class="va">p</span>, adjust <span class="op">=</span> <span class="st">"liji"</span>,   R <span class="op">=</span> <span class="fu"><a href="mvnconv.html">mvnconv</a></span><span class="op">(</span><span class="va">r</span>, target <span class="op">=</span> <span class="st">"p"</span>, cov2cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-values with:      inverse chi-square method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of p-values combined: 23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test statistic:              77.808 ~ chi-square(df = 21) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjustment:                  effective number of tests (m = 21; Li &amp; Ji, 2005) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-value:            1.87e-08 </span>
<span class="r-in"><span class="fu">invchisq</span><span class="op">(</span><span class="va">p</span>, adjust <span class="op">=</span> <span class="st">"gao"</span>,    R <span class="op">=</span> <span class="fu"><a href="mvnconv.html">mvnconv</a></span><span class="op">(</span><span class="va">r</span>, target <span class="op">=</span> <span class="st">"p"</span>, cov2cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-values with:      inverse chi-square method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of p-values combined: 23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test statistic:              85.219 ~ chi-square(df = 23) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjustment:                  effective number of tests (m = 23; Gao, 2008) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-value:            4.45e-09 </span>
<span class="r-in"><span class="fu">invchisq</span><span class="op">(</span><span class="va">p</span>, adjust <span class="op">=</span> <span class="st">"galwey"</span>, R <span class="op">=</span> <span class="fu"><a href="mvnconv.html">mvnconv</a></span><span class="op">(</span><span class="va">r</span>, target <span class="op">=</span> <span class="st">"p"</span>, cov2cor <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-values with:      inverse chi-square method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of p-values combined: 23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test statistic:              74.103 ~ chi-square(df = 20) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjustment:                  effective number of tests (m = 20; Galwey, 2009) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-value:            3.84e-08 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># setting argument 'm' manually</span></span>
<span class="r-in"><span class="fu">invchisq</span><span class="op">(</span><span class="va">p</span>, m <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-values with:      inverse chi-square method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of p-values combined: 23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test statistic:              44.462 ~ chi-square(df = 12) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjustment:                  effective number of tests (m = 12; user-defined) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-value:            1.27e-05 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># adjustment based on an empirically-derived null distribution (setting the</span></span>
<span class="r-in"><span class="co"># seed for reproducibility)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">invchisq</span><span class="op">(</span><span class="va">p</span>, adjust <span class="op">=</span> <span class="st">"empirical"</span>, R <span class="op">=</span> <span class="va">r</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-values with:      inverse chi-square method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of p-values combined: 23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test statistic:              85.219 ~ chi-square(df = 23) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjustment:                  empirical distribution (size = 10000) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-value:            7e-04 (95% CI: 0.000281, 0.00144) </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># generate the empirical distribution in batches of size 100</span></span>
<span class="r-in"><span class="fu">invchisq</span><span class="op">(</span><span class="va">p</span>, adjust <span class="op">=</span> <span class="st">"empirical"</span>, R <span class="op">=</span> <span class="va">r</span>, batchsize <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-values with:      inverse chi-square method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of p-values combined: 23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test statistic:              85.219 ~ chi-square(df = 23) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjustment:                  empirical distribution (size = 10000) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-value:            0.0016 (95% CI: 0.000915, 0.0026) </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># using the stepwise algorithm (not run, because this takes slightly longer</span></span>
<span class="r-in"><span class="co"># and can lead to a note when running the standard package checks)</span></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="fu">invchisq</span><span class="op">(</span><span class="va">p</span>, adjust <span class="op">=</span> <span class="st">"empirical"</span>, R <span class="op">=</span> <span class="va">r</span>, size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">10000</span>, <span class="fl">100000</span><span class="op">)</span>, threshold <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.10</span>, <span class="fl">.01</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-values with:      inverse chi-square method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of p-values combined: 23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test statistic:              85.219 ~ chi-square(df = 23) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjustment:                  empirical distribution (size = 100000) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-value:            0.00122 (95% CI: 0.00101, 0.00146) </span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># use mvnconv() to convert the LD correlation matrix into a matrix with the</span></span>
<span class="r-in"><span class="co"># covariances among the (two-sided) 'F(1-p_i,1)' values assuming that the</span></span>
<span class="r-in"><span class="co"># test statistics follow a multivariate normal distribution with correlation</span></span>
<span class="r-in"><span class="co"># matrix r (note: 'side = 2' by default in mvnconv())</span></span>
<span class="r-in"><span class="fu"><a href="mvnconv.html">mvnconv</a></span><span class="op">(</span><span class="va">r</span>, target <span class="op">=</span> <span class="st">"chisq1"</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="co"># show only rows/columns 1-5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1]   [,2]   [,3]   [,4]   [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.0000 0.0699 0.0737 0.0338 0.3025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.0699 2.0000 0.0420 0.0002 0.1351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.0737 0.0420 2.0000 0.0188 0.0196</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.0338 0.0002 0.0188 2.0000 0.0007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5,] 0.3025 0.1351 0.0196 0.0007 2.0000</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># adjustment based on generalized method</span></span>
<span class="r-in"><span class="fu">invchisq</span><span class="op">(</span><span class="va">p</span>, adjust <span class="op">=</span> <span class="st">"generalized"</span>, R <span class="op">=</span> <span class="fu"><a href="mvnconv.html">mvnconv</a></span><span class="op">(</span><span class="va">r</span>, target <span class="op">=</span> <span class="st">"chisq1"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-values with:      inverse chi-square method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of p-values combined: 23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test statistic:              27.449 ~ chi-square(df = 7.408) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjustment:                  Satterthwaite approximation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-value:            0.000381 </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># when using mvnconv() inside invchisq() with adjust = "generalized", the</span></span>
<span class="r-in"><span class="co"># 'target' argument is automatically set and doesn't need to be specified</span></span>
<span class="r-in"><span class="fu">invchisq</span><span class="op">(</span><span class="va">p</span>, adjust <span class="op">=</span> <span class="st">"generalized"</span>, R <span class="op">=</span> <span class="fu"><a href="mvnconv.html">mvnconv</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-values with:      inverse chi-square method</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> number of p-values combined: 23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> test statistic:              27.449 ~ chi-square(df = 7.408) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> adjustment:                  Satterthwaite approximation </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> combined p-value:            0.000381 </span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Ozan Cinar, Wolfgang Viechtbauer.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

